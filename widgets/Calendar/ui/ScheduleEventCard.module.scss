/**
 * ScheduleEventCard 스타일 - 일정 카드 컴포넌트
 * VLANET Design Tokens 사용
 */

@use '@/shared/config/design-tokens.scss' as *;

// ===========================
// 기본 이벤트 카드 스타일
// ===========================

.eventCard {
  position: relative;
  border-radius: 8px; // 작은 카드는 8px
  padding: $spacing-xs;
  margin-bottom: $spacing-xs-half;
  cursor: pointer;
  transition: $transition-all;
  overflow: hidden;
  min-height: 24px;
  display: flex;
  align-items: stretch;
  
  // 기본 호버 효과
  &:hover {
    transform: translateY(-1px);
    box-shadow: $shadow-md;
    z-index: $z-index-10;
  }
  
  &:focus {
    @include focus-visible;
    z-index: $z-index-20;
  }
  
  // 드래깅 상태
  &.dragging {
    opacity: 0.7;
    transform: rotate(2deg);
    z-index: $z-index-50;
    cursor: grabbing;
  }
  
  // 완료된 이벤트
  &.completed {
    opacity: 0.6;
    
    .eventTitle {
      text-decoration: line-through;
    }
  }
  
  // 높은 우선순위 이벤트
  &.highPriority {
    border-left-width: 6px;
    
    &::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 3px;
      background: linear-gradient(90deg, $color-error, $color-warning);
    }
  }
}

// ===========================
// 뷰 모드별 스타일
// ===========================

// 월간 뷰 - 컴팩트한 표시
.eventCard.month {
  padding: $spacing-xs-half $spacing-xs;
  margin-bottom: 2px;
  min-height: 18px;
  
  .eventTitle {
    font-size: $font-size-xs;
    line-height: $line-height-tight;
  }
  
  .eventMeta {
    display: none; // 월간 뷰에서는 메타 정보 숨김
  }
  
  .eventActions {
    display: none; // 월간 뷰에서는 액션 버튼 숨김
  }
  
  @include mobile {
    font-size: 10px;
    padding: 2px 4px;
    min-height: 16px;
  }
}

// 주간 뷰 - 중간 크기
.eventCard.week {
  padding: $spacing-xs;
  min-height: 30px;
  
  .eventTitle {
    font-size: $font-size-sm;
  }
  
  .eventDescription {
    display: none; // 주간 뷰에서는 설명 숨김
  }
  
  .projectInfo {
    font-size: $font-size-xs;
  }
}

// 일간 뷰 - 전체 정보 표시
.eventCard.day {
  padding: $spacing-sm;
  min-height: 50px;
  
  .eventTitle {
    font-size: $font-size-base;
    margin-bottom: $spacing-xs-half;
  }
}

// 컴팩트 모드
.eventCard.compact {
  padding: $spacing-xs-half;
  min-height: 20px;
  
  .eventTitle {
    font-size: $font-size-xs;
    @include truncate;
  }
  
  .eventActions,
  .eventDescription,
  .projectInfo,
  .assignees {
    display: none;
  }
  
  .dragHandle {
    display: none;
  }
}

// ===========================
// 이벤트 내용 레이아웃
// ===========================

.eventContent {
  flex: 1;
  display: flex;
  flex-direction: column;
  min-width: 0; // flex item이 줄어들 수 있도록
}

.eventHeader {
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  margin-bottom: $spacing-xs-half;
}

.eventMeta {
  display: flex;
  align-items: center;
  gap: $spacing-xs-half;
  font-size: $font-size-xs;
}

.categoryIcon {
  font-size: $font-size-xs;
  line-height: 1;
}

.priorityIndicator {
  font-size: $font-size-xs;
  line-height: 1;
}

.timeDisplay {
  color: rgba(var(--text-color), 0.7);
  font-weight: $font-weight-medium;
  font-size: $font-size-xs;
}

.eventActions {
  display: flex;
  gap: $spacing-xs-half;
  opacity: 0;
  transition: $transition-opacity;
  
  .eventCard:hover & {
    opacity: 1;
  }
}

.actionButton {
  @include button-base;
  padding: 2px;
  font-size: 12px;
  background: rgba(255, 255, 255, 0.8);
  border: none;
  border-radius: $radius-sm;
  color: currentColor;
  
  &:hover {
    background: rgba(255, 255, 255, 1);
    transform: scale(1.1);
  }
}

// ===========================
// 이벤트 정보 표시
// ===========================

.eventTitle {
  font-weight: $font-weight-semibold;
  color: currentColor;
  margin-bottom: $spacing-xs-half;
  @include truncate;
  
  .eventCard.month & {
    margin-bottom: 0;
  }
}

.eventDescription {
  font-size: $font-size-xs;
  color: rgba(var(--text-color), 0.8);
  margin-bottom: $spacing-xs-half;
  display: -webkit-box;
  -webkit-line-clamp: 2;
  -webkit-box-orient: vertical;
  overflow: hidden;
  line-height: $line-height-tight;
}

.projectInfo {
  display: flex;
  align-items: center;
  gap: $spacing-xs-half;
  font-size: $font-size-xs;
  margin-bottom: $spacing-xs-half;
}

.projectLabel {
  color: rgba(var(--text-color), 0.7);
  font-weight: $font-weight-medium;
}

.projectTitle {
  font-weight: $font-weight-semibold;
  @include truncate;
}

.assignees {
  display: flex;
  align-items: center;
  gap: $spacing-xs-half;
  font-size: $font-size-xs;
  color: rgba(var(--text-color), 0.8);
}

.assigneeIcon {
  font-size: $font-size-xs;
}

.assigneeCount {
  font-weight: $font-weight-medium;
}

// ===========================
// 상태 배지
// ===========================

.completedBadge,
.recurrenceBadge {
  position: absolute;
  top: $spacing-xs-half;
  right: $spacing-xs-half;
  font-size: 10px;
  line-height: 1;
  z-index: $z-index-10;
}

.completedBadge {
  right: $spacing-xs;
}

.recurrenceBadge {
  right: $spacing-xs-half;
  top: auto;
  bottom: $spacing-xs-half;
}

// ===========================
// 드래그 핸들
// ===========================

.dragHandle {
  position: absolute;
  left: 2px;
  top: 50%;
  transform: translateY(-50%);
  font-size: 12px;
  color: rgba(var(--text-color), 0.3);
  cursor: grab;
  opacity: 0;
  transition: $transition-opacity;
  user-select: none;
  line-height: 1;
  
  .eventCard:hover & {
    opacity: 1;
  }
  
  &:hover {
    color: rgba(var(--text-color), 0.6);
  }
}

// ===========================
// 충돌 표시
// ===========================

.conflictIndicator {
  position: absolute;
  top: -2px;
  right: -2px;
  width: 8px;
  height: 8px;
  background: $color-warning;
  border: $border-1 solid $color-white;
  border-radius: $radius-full;
  z-index: $z-index-20;
}

// ===========================
// 접근성 개선
// ===========================

// 키보드 포커스 표시
.eventCard:focus {
  outline: $border-2 solid currentColor;
  outline-offset: 2px;
}

// 고대비 모드 지원
@media (prefers-contrast: high) {
  .eventCard {
    border: $border-1 solid currentColor;
    
    &:hover {
      border-width: $border-2;
    }
  }
  
  .actionButton {
    background: $color-white;
    border: $border-1 solid currentColor;
  }
}

// 움직임 줄이기 모드
@media (prefers-reduced-motion: reduce) {
  .eventCard {
    transition: none;
    
    &:hover {
      transform: none;
    }
    
    &.dragging {
      transform: none;
    }
  }
  
  .actionButton,
  .eventActions,
  .dragHandle {
    transition: none;
  }
}

// ===========================
// 프로젝트 색상 테마
// ===========================

// 동적 색상 지원을 위한 CSS 변수
.eventCard {
  --text-color: #{rgb(0, 49, 255)};
  --bg-color: #{rgba(0, 49, 255, 0.1)};
  --border-color: #{rgb(0, 49, 255)};
  
  color: rgb(var(--text-color));
  background-color: rgb(var(--bg-color));
  border-left: 4px solid rgb(var(--border-color));
}

// 카테고리별 기본 색상
.eventCard {
  &[data-category="meeting"] {
    --text-color: #{rgb(40, 167, 69)};
    --bg-color: #{rgba(40, 167, 69, 0.1)};
    --border-color: #{rgb(40, 167, 69)};
  }
  
  &[data-category="project-deadline"] {
    --text-color: #{rgb(220, 53, 69)};
    --bg-color: #{rgba(220, 53, 69, 0.1)};
    --border-color: #{rgb(220, 53, 69)};
  }
  
  &[data-category="milestone"] {
    --text-color: #{rgb(255, 193, 7)};
    --bg-color: #{rgba(255, 193, 7, 0.1)};
    --border-color: #{rgb(255, 193, 7)};
  }
  
  &[data-category="personal"] {
    --text-color: #{rgb(108, 117, 125)};
    --bg-color: #{rgba(108, 117, 125, 0.1)};
    --border-color: #{rgb(108, 117, 125)};
  }
  
  &[data-category="holiday"] {
    --text-color: #{rgb(220, 53, 69)};
    --bg-color: #{rgba(220, 53, 69, 0.1)};
    --border-color: #{rgb(220, 53, 69)};
  }
}

// ===========================
// 레거시 디자인 시스템 호환
// ===========================

// 레거시 카드 스타일 적용
.eventCard {
  border-radius: 8px; // 작은 카드용 8px 반경
  
  &:not(.compact) {
    box-shadow: $shadow-sm;
    
    &:hover {
      box-shadow: $shadow-md;
    }
  }
}

// 호버 리프트 효과
.eventCard:not(.compact) {
  @include hover-lift;
}