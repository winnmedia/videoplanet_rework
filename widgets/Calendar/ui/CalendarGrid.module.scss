/**
 * CalendarGrid 스타일 - 월간/주간/일간 뷰 그리드
 * VLANET Design Tokens 사용
 */

@use '@/shared/config/design-tokens.scss' as *;

// ===========================
// 공통 그리드 스타일
// ===========================

.calendarGrid,
.weekGrid,
.dayGrid {
  width: 100%;
  border-radius: $radius-lg;
  background: $color-white;
  overflow: hidden;
  border: $border-1 solid $color-gray-200;
}

// ===========================
// 월간 뷰 스타일
// ===========================

.monthHeader {
  display: grid;
  grid-template-columns: repeat(7, 1fr);
  background: $bg-secondary;
  border-bottom: $border-1 solid $color-gray-200;
  
  // 주 번호 컬럼 추가 시
  &:has(.weekNumberHeader) {
    grid-template-columns: 50px repeat(7, 1fr);
  }
}

.weekNumberHeader {
  display: flex;
  align-items: center;
  justify-content: center;
  padding: $spacing-sm;
  font-size: $font-size-xs;
  font-weight: $font-weight-semibold;
  color: $color-gray-500;
  border-right: $border-1 solid $color-gray-200;
}

.dayHeader {
  display: flex;
  align-items: center;
  justify-content: center;
  padding: $spacing-sm;
  font-size: $font-size-sm;
  font-weight: $font-weight-semibold;
  color: $color-gray-700;
  
  &:not(:last-child) {
    border-right: $border-1 solid $color-gray-200;
  }
  
  // 주말 스타일
  &:first-child,
  &:last-child {
    color: $color-error;
  }
}

.monthGrid {
  display: flex;
  flex-direction: column;
}

.weekRow {
  display: grid;
  grid-template-columns: repeat(7, 1fr);
  border-bottom: $border-1 solid $color-gray-200;
  
  &:last-child {
    border-bottom: none;
  }
  
  // 주 번호 컬럼 추가 시
  &:has(.weekNumber) {
    grid-template-columns: 50px repeat(7, 1fr);
  }
}

.weekNumber {
  display: flex;
  align-items: center;
  justify-content: center;
  padding: $spacing-sm;
  font-size: $font-size-xs;
  color: $color-gray-500;
  border-right: $border-1 solid $color-gray-200;
  background: $bg-tertiary;
}

.dayCell {
  min-height: 100px;
  padding: $spacing-xs;
  border-right: $border-1 solid $color-gray-200;
  cursor: pointer;
  transition: $transition-colors;
  position: relative;
  display: flex;
  flex-direction: column;
  
  &:last-child {
    border-right: none;
  }
  
  &:hover {
    background: $bg-secondary;
  }
  
  &:focus {
    @include focus-visible;
    z-index: $z-index-10;
  }
  
  // 오늘 날짜 스타일
  &.today {
    background: $color-primary-lighter;
    
    .dateNumber {
      background: $color-primary;
      color: $color-white;
      font-weight: $font-weight-bold;
    }
  }
  
  // 선택된 날짜 스타일
  &.selected {
    background: $color-primary-light;
    border: $border-2 solid $color-primary;
    
    .dateNumber {
      color: $color-primary;
      font-weight: $font-weight-bold;
    }
  }
  
  // 다른 월의 날짜
  &.otherMonth {
    background: $color-gray-50;
    color: $color-gray-400;
    
    .dateNumber {
      color: $color-gray-400;
    }
  }
  
  // 주말 스타일
  &.weekend {
    .dateNumber {
      color: $color-error;
    }
  }
  
  @include mobile {
    min-height: 80px;
    padding: $spacing-xs-half;
  }
}

.dateNumber {
  width: 28px;
  height: 28px;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: $radius-full;
  font-size: $font-size-sm;
  font-weight: $font-weight-medium;
  margin-bottom: $spacing-xs;
  
  @include mobile {
    width: 24px;
    height: 24px;
    font-size: $font-size-xs;
  }
}

.eventsContainer {
  flex: 1;
  display: flex;
  flex-direction: column;
  gap: $spacing-xs-half;
  overflow: hidden;
}

.moreEvents {
  font-size: $font-size-xs;
  color: $color-gray-500;
  text-align: center;
  padding: $spacing-xs-half;
  background: $color-gray-100;
  border-radius: $radius-sm;
  cursor: pointer;
  
  &:hover {
    background: $color-gray-200;
    color: $color-primary;
  }
}

// ===========================
// 주간 뷰 스타일
// ===========================

.weekHeader {
  display: grid;
  grid-template-columns: 80px repeat(7, 1fr);
  background: $bg-secondary;
  border-bottom: $border-1 solid $color-gray-200;
  position: sticky;
  top: 0;
  z-index: $z-index-20;
  
  @include mobile {
    grid-template-columns: 60px repeat(5, 1fr); // 주말 숨김
  }
}

.timeColumn {
  display: flex;
  align-items: center;
  justify-content: center;
  padding: $spacing-sm;
  font-size: $font-size-xs;
  font-weight: $font-weight-semibold;
  color: $color-gray-500;
  border-right: $border-1 solid $color-gray-200;
}

.weekDayHeader {
  display: flex;
  flex-direction: column;
  align-items: center;
  padding: $spacing-sm;
  border-right: $border-1 solid $color-gray-200;
  
  &:last-child {
    border-right: none;
  }
  
  &.today {
    background: $color-primary-lighter;
    
    .dayDate {
      background: $color-primary;
      color: $color-white;
    }
  }
}

.dayName {
  font-size: $font-size-xs;
  font-weight: $font-weight-semibold;
  color: $color-gray-600;
  margin-bottom: $spacing-xs-half;
}

.dayDate {
  font-size: $font-size-sm;
  font-weight: $font-weight-medium;
  color: $color-gray-700;
  padding: $spacing-xs-half $spacing-xs;
  border-radius: $radius-full;
  min-width: 28px;
  text-align: center;
}

.weekContent {
  max-height: 600px;
  overflow-y: auto;
  
  @include mobile {
    max-height: 400px;
  }
}

.timeRow {
  display: grid;
  grid-template-columns: 80px repeat(7, 1fr);
  border-bottom: $border-1 solid $color-gray-100;
  min-height: 60px;
  
  &:last-child {
    border-bottom: none;
  }
  
  @include mobile {
    grid-template-columns: 60px repeat(5, 1fr);
  }
}

.timeLabel {
  display: flex;
  align-items: flex-start;
  justify-content: center;
  padding: $spacing-xs;
  font-size: $font-size-xs;
  color: $color-gray-500;
  border-right: $border-1 solid $color-gray-200;
  background: $color-gray-50;
}

.timeSlot {
  border-right: $border-1 solid $color-gray-100;
  cursor: pointer;
  position: relative;
  transition: $transition-colors;
  padding: $spacing-xs-half;
  
  &:last-child {
    border-right: none;
  }
  
  &:hover {
    background: $color-primary-lighter;
  }
  
  &:focus {
    @include focus-visible;
    z-index: $z-index-10;
  }
}

// ===========================
// 일간 뷰 스타일
// ===========================

.dayHeader {
  display: grid;
  grid-template-columns: 80px 1fr;
  background: $bg-secondary;
  border-bottom: $border-1 solid $color-gray-200;
  
  @include mobile {
    grid-template-columns: 60px 1fr;
  }
}

.dayColumn {
  display: flex;
  align-items: center;
  padding: $spacing-md;
  font-size: $font-size-lg;
  font-weight: $font-weight-semibold;
  color: $color-gray-700;
}

.dayContent {
  max-height: 700px;
  overflow-y: auto;
}

.dayTimeRow {
  display: grid;
  grid-template-columns: 80px 1fr;
  border-bottom: $border-1 solid $color-gray-100;
  min-height: 60px;
  
  @include mobile {
    grid-template-columns: 60px 1fr;
  }
}

.dayTimeSlot {
  border-right: none;
  cursor: pointer;
  position: relative;
  transition: $transition-colors;
  padding: $spacing-sm;
  
  &:hover {
    background: $color-primary-lighter;
  }
  
  &:focus {
    @include focus-visible;
    z-index: $z-index-10;
  }
}

// ===========================
// 접근성 및 상호작용 개선
// ===========================

// 키보드 포커스 관리
.dayCell:focus,
.timeSlot:focus,
.dayTimeSlot:focus {
  outline: $border-2 solid $color-primary;
  outline-offset: -2px;
}

// 고대비 모드 지원
@media (prefers-contrast: high) {
  .calendarGrid,
  .weekGrid,
  .dayGrid {
    border: $border-2 solid $color-gray-900;
  }
  
  .dayCell,
  .timeSlot {
    &:hover {
      background: $color-primary;
      color: $color-white;
    }
  }
  
  .today {
    border: $border-2 solid $color-primary;
  }
}

// 움직임 줄이기 모드
@media (prefers-reduced-motion: reduce) {
  .dayCell,
  .timeSlot,
  .dayTimeSlot {
    transition: none;
  }
}

// ===========================
// 드래그 앤 드롭 지원
// ===========================

.timeSlot,
.dayTimeSlot,
.dayCell {
  &[data-drop-zone="active"] {
    background: $color-primary-lighter;
    border: $border-2 dashed $color-primary;
  }
  
  &[data-drop-zone="invalid"] {
    background: rgba($color-error, 0.1);
    border: $border-2 dashed $color-error;
  }
  
  // 드래그 오버 상태
  &.dragOver {
    background: $color-primary-lighter;
    border: $border-2 dashed $color-primary;
  }
  
  // 충돌 상태
  &.conflict {
    background: rgba($color-warning, 0.1);
    border-color: $color-warning;
  }
}

// Drop zone indicator
.dropZoneActive {
  background: $color-primary-lighter !important;
  border: $border-2 dashed $color-primary !important;
}

.dropZone {
  position: absolute;
  inset: 0;
  opacity: 0;
  transition: $transition-opacity;
  
  &.active {
    opacity: 0.1;
    background: $color-primary;
  }
}

// ===========================
// 레거시 디자인 시스템 호환
// ===========================

// 테이블 셀 hover 효과
.dayCell {
  @include hover-lift;
}

// 충돌 표시기
.conflictIndicator {
  position: absolute;
  top: $spacing-xs;
  right: $spacing-xs;
  width: 12px;
  height: 12px;
  background: $color-warning;
  border-radius: $radius-full;
  border: $border-2 solid $color-white;
  z-index: $z-index-10;
}

.conflictTooltip {
  position: absolute;
  top: $spacing-lg;
  right: $spacing-xs;
  background: $color-gray-900;
  color: $color-white;
  padding: $spacing-xs $spacing-sm;
  border-radius: $radius-md;
  font-size: $font-size-xs;
  white-space: nowrap;
  z-index: $z-index-20;
  pointer-events: none;
  opacity: 0.9;
}

// 프로젝트 색상 강조
.primaryHighlight {
  border-left: 4px solid $color-primary;
  padding-left: $spacing-sm - 4px;
}

// 레거시 카드 스타일
.legacyCard {
  border-radius: 8px; // 작은 카드는 8px
  box-shadow: $shadow-sm;
}